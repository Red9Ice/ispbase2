/**
 * @file: tasktracker.md
 * @description: Development task tracking and status.
 * @dependencies: docs/project.md
 * @created: 2026-01-26
 */

# Task Tracker

## Задача: Переход EventsRepository на PostgreSQL
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Переписать EventsRepository для работы с PostgreSQL вместо in-memory хранилища, чтобы отображались все мероприятия из базы данных, а не только 50 жестко закодированных.
- **Шаги выполнения**:
  - [x] Переписать EventsRepository для работы с PostgreSQL
  - [x] Реализовать методы list, getById, create, update, remove с использованием pool из database.ts
  - [x] Добавить маппинг полей базы данных в EventRecord
  - [x] Обновить EventsServiceImpl для работы с асинхронными методами репозитория
  - [x] Проверить компиляцию TypeScript
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Database connection, Events module
- **Результат**: Теперь все мероприятия из базы данных (500+) отображаются в интерфейсе

## Задача: Генерация тестовых мероприятий для тестирования
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Создать скрипт для генерации тестовых мероприятий с большими описаниями, продолжительностью 10-20 дней, равномерно распределенных по 2025-2026 годам для тестирования системы. Поддержка генерации любого количества мероприятий.
- **Шаги выполнения**:
  - [x] Создать скрипт generate-test-events.ts для генерации тестовых данных
  - [x] Реализовать генерацию больших текстовых описаний (средняя длина ~1470 символов)
  - [x] Реализовать генерацию дат с продолжительностью 10-20 дней
  - [x] Реализовать равномерное распределение мероприятий по 2025-2026 годам
  - [x] Добавить поддержку переменной окружения EVENTS_COUNT для указания количества
  - [x] Добавить автоматический подсчет существующих мероприятий и продолжение нумерации
  - [x] Добавить автоматическое создание тестовых клиентов и площадок при их отсутствии
  - [x] Добавить команду npm run generate:test-events в package.json
  - [x] Исправить парсинг connection string для поддержки Unix socket
  - [x] Сгенерировать 500 тестовых мероприятий (100 + 400)
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Database connection, Events module
- **Результат**: Создано 500 тестовых мероприятий, равномерно распределенных по 2025-2026 годам

## Задача: Добавление новых полей в мероприятия
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Добавить в мероприятия новые поля: Менеджер (уже был), Бригадир, КП, ОПМ, Транспорт, Маржинальность, Рентабельность. Переименовать "Бюджет" в "Цена контракта".
- **Шаги выполнения**:
  - [x] Обновить EventDto: добавить новые поля и переименовать budgetPlanned в contractPrice
  - [x] Создать миграцию SQL для добавления новых полей в таблицу event
  - [x] Обновить валидацию событий для новых полей
  - [x] Обновить репозиторий events (заменить budgetPlanned на contractPrice)
  - [x] Обновить сервисы events (заменить budgetPlanned на contractPrice)
  - [x] Обновить документацию (changelog.md, tasktracker.md, api.md)
- **Зависимости**: Events module, Database migrations

## Задача: Добавление трех режимов отображения мероприятий
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Добавить три режима отображения мероприятий: Список (текущий вид), Табличный календарь (плитки по дням недели), Горизонтальный календарь (таймлайн/диаграмма Ганта). Реализовать интерактивные колбаски мероприятий с возможностью изменения дат перетаскиванием.
- **Шаги выполнения**:
  - [x] Добавить состояние режима отображения и три иконки переключения в заголовок страницы мероприятий
  - [x] Создать компонент EventsListView (текущий список мероприятий)
  - [x] Создать компонент EventsTableView (табличный календарь с днями недели)
  - [x] Создать компонент EventsTimelineView (горизонтальный таймлайн/диаграмма Ганта)
  - [x] Реализовать общий компонент EventBar (колбаска мероприятия) с интерактивностью
  - [x] Добавить стили для всех трех режимов отображения
  - [x] Обновить документацию (changelog.md и tasktracker.md)
- **Зависимости**: Events module, Frontend components

## Задача: Добавление виджета расстояния и времени поездки
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Создать виджет в заголовке мероприятия, который показывает расстояние и время поездки от Кирова (основной город компании) до города мероприятия.
- **Шаги выполнения**:
  - [x] Создать модуль distance с сервисом для расчета расстояния и времени (distance.service.ts, distance.service.impl.ts)
  - [x] Создать DTO для расстояния (distance.dto.ts)
  - [x] Реализовать расчет расстояния по формуле гаверсинуса
  - [x] Реализовать оценку времени поездки на основе средних скоростей
  - [x] Обновить EventDto для включения данных о расстоянии
  - [x] Интегрировать сервис расстояния в EventsServiceImpl
  - [x] Обновить main.ts для инициализации DistanceService
  - [x] Добавить виджет расстояния в EventDetailPage рядом с виджетом погоды
  - [x] Добавить стили для виджета расстояния
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Events, Venues, Distance API (Nominatim для геокодинга)

## Задача: Добавление раздела с погодой для мероприятий
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Добавить в каждое мероприятие раздел с погодой, которая будет привязываться к городу, указанному в мероприятии, и времени даты начала мероприятия.
- **Шаги выполнения**:
  - [x] Создать утилиту для извлечения города из venue (venue-utils.ts)
  - [x] Создать модуль weather с сервисом погоды (weather.service.ts, weather.service.impl.ts)
  - [x] Создать DTO для погоды (weather.dto.ts)
  - [x] Обновить EventDto для включения данных о погоде
  - [x] Интегрировать сервис погоды в EventsServiceImpl
  - [x] Обновить main.ts для инициализации WeatherService
  - [x] Обновить frontend EventDto для включения погоды
  - [x] Добавить отображение погоды в EventDetailPage
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Events, Venues, Weather API (Open-Meteo)

## Задача: Оптимизация кода и исправление ошибок
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Оптимизировать весь код, исправить все найденные ошибки, улучшить типизацию и обработку ошибок.
- **Шаги выполнения**:
  - [x] Исправить типы в database.ts (заменить any на PoolConfig)
  - [x] Исправить типы в users.repository.ts (убрать any, исправить обработку null)
  - [x] Добавить валидацию в tasks.service.impl.ts
  - [x] Создать унифицированный обработчик ошибок (error-handler.ts)
  - [x] Применить унифицированный обработчик ошибок в main.ts
  - [x] Добавить валидацию ID параметров во всех маршрутах
  - [x] Проверить компиляцию TypeScript
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Все модули backend

## Задача: Кнопка «Показать пароль» на страницах входа и регистрации
- **Статус**: Завершена
- **Приоритет**: Низкий
- **Описание**: Добавить кнопку переключения видимости пароля (показать/скрыть) на странице входа и на странице регистрации (для полей «Пароль» и «Подтвердите пароль»).
- **Шаги выполнения**:
  - [x] Добавить кнопку и состояние в Login.tsx
  - [x] Добавить кнопки и состояния в Register.tsx
  - [x] Стили для обёртки и кнопки в Login.css
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Login, Register, Login.css

## Задача: Окно входа/регистрации в стиле liquid glass
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Оформить страницы входа и регистрации в стиле liquid glass: полупрозрачная карточка, стеклянные поля ввода (backdrop-filter, блики, мягкие границы).
- **Шаги выполнения**:
  - [x] Обновить Login.css: карточка и инпуты в стиле liquid glass
  - [x] Поддержать светлую и тёмную темы
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Login, Register, CanvasParticlesBackground, темы

## Задача: Добавление подстраниц "имлайт" и "фриланс" на вкладке персонал
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Добавить подстраницы с названиями "имлайт" и "фриланс" на вкладке персонал для разделения типов сотрудников.
- **Шаги выполнения**:
  - [x] Создать компонент StaffPage.tsx с системой табов
  - [x] Создать CSS стили для табов персонала
  - [x] Обновить App.tsx для использования StaffPage
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Компонент персонала, система навигации

## Задача: Добавление категории "Кейсы" на склад
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Добавить возможность работы с кейсами на складе как отдельной категории. Создать вкладку "Кейсы" в интерфейсе склада с таблицей, фильтрами, поиском и пагинацией.
- **Шаги выполнения**:
  - [x] Создать компонент WarehouseCasesTab.tsx для работы с кейсами
  - [x] Создать CSS стили для WarehouseCasesTab
  - [x] Добавить вкладку "Кейсы" в WarehousePage.tsx
  - [x] Обновить типы и интерфейсы для поддержки кейсов
  - [x] Добавить обработчики для работы с кейсами в App.tsx
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Компонент WarehousePage, система склада

## Задача: Переписывание Dashboard с приветственным экраном настройки
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Переписать компонент Dashboard с нуля и создать приветственный экран, который будет предлагать настроить dashboard и добавить виджеты на свой вкус. Улучшить UX выбора и управления виджетами.
- **Шаги выполнения**:
  - [x] Исследовать текущую структуру Dashboard и понять его устройство
  - [x] Создать компонент WelcomeScreen с приветственным экраном настройки
  - [x] Добавить стили для WelcomeScreen с анимированными градиентами
  - [x] Переписать Dashboard.tsx с улучшенной логикой показа приветственного экрана
  - [x] Обновить useWidgets.ts для создания виджетов по умолчанию как невидимых
  - [x] Улучшить WidgetManager с иконками виджетов и улучшенным поиском
  - [x] Обновить стили для нового дизайна
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Система виджетов (widgets), WidgetContext, useWidgets hook

## Задача: Стандартный календарь с вертикальной прокруткой
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Создать стандартный календарь с сеткой по дням недели, вертикальной прокруткой и месяцами друг под другом. Мероприятия отображаются в виде цветных полосок с названиями. При наведении показывается всплывающее окно с информацией, остальные полоски тускнеют, выделенная увеличивается.
- **Шаги выполнения**:
  - [x] Создать компонент StandardCalendar.tsx с сеткой по дням недели
  - [x] Реализовать вертикальную прокрутку и отображение месяцев друг под другом
  - [x] Добавить цветные полоски мероприятий с названиями (цвет по статусам)
  - [x] Реализовать всплывающее окно при наведении на мероприятие
  - [x] Добавить эффект затемнения остальных полосок при наведении
  - [x] Реализовать увеличение выделенной полоски при наведении
  - [x] Создать стили StandardCalendar.css
  - [x] Интегрировать новый календарь в CalendarPage
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: API для мероприятий (events), API для настроек статусов (settings)

## Задача: Раздел "Отправки оборудования" в календаре мероприятий
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Добавить в календарь мероприятий раздел, в котором будет видно в каком мероприятии, куда и какое оборудование поехало. Создать календарь с вкладками для переключения между мероприятиями и отправками оборудования.
- **Шаги выполнения**:
  - [x] Создать компонент CalendarPage с вкладками (Мероприятия, Отправки оборудования)
  - [x] Создать компонент EquipmentShipmentsTab для отображения отправок оборудования
  - [x] Реализовать таблицу с информацией о мероприятиях, оборудовании и местах назначения
  - [x] Добавить поиск по отправкам оборудования
  - [x] Интегрировать CalendarPage в раздел мероприятий
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: API для движений оборудования (equipment-movements), API для мероприятий (events), API для оборудования (equipment)

## Задача: Сохранение профиля пользователя в базе данных PostgreSQL
- **Статус**: Завершена
- **Приоритет**: Критический
- **Описание**: Перевести хранение данных пользователей из in-memory хранилища в PostgreSQL для обеспечения персистентности данных. При обновлении страницы настройки профиля не должны сбрасываться.
- **Шаги выполнения**:
  - [x] Создать миграцию для таблицы `user` в PostgreSQL
  - [x] Создать общий модуль для подключения к базе данных (common/database.ts)
  - [x] Переписать UsersRepository для работы с PostgreSQL
  - [x] Обновить AuthService для работы с асинхронными методами репозитория
  - [x] Обновить auth-routes.ts для работы с асинхронными методами
  - [x] Обновить seed.ts для работы с асинхронными методами
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: PostgreSQL база данных, система авторизации

## Задача: Профиль пользователя с возможностью редактирования и отображением в истории изменений
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Добавить профиль пользователя с возможностью просмотра и редактирования имени, фамилии, email, установки аватарки и смены пароля. В истории изменений отображать имя, фамилию и аватарку пользователя вместо только ID.
- **Шаги выполнения**:
  - [x] Обновить UserDto и UserRecord: добавить поля firstName, lastName, avatarUrl
  - [x] Обновить UsersRepository: добавить метод updateProfile
  - [x] Обновить AuthService: добавить методы updateProfile и updatePassword
  - [x] Создать API endpoints: GET/PATCH /auth/profile, PATCH /auth/password, GET /users/:id
  - [x] Обновить фронтенд API: добавить методы для работы с профилем
  - [x] Создать компонент Profile с формой редактирования и смены пароля
  - [x] Добавить страницу профиля в App.tsx и навигацию
  - [x] Обновить компонент History: показывать имя, фамилию и аватарку пользователя
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Система авторизации, история изменений

## Задача: Инструмент виртуальной погрузки грузовой машины
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Создать инструмент для виртуальной погрузки грузовой машины, в который можно добавлять кейсы со склада с указанием размеров и веса, визуализировать прицеп с погруженными кейсами и быстро менять вариант погрузки.
- **Шаги выполнения**:
  - [x] Создать компонент VirtualLoading с интерфейсом для работы с кейсами
  - [x] Реализовать алгоритм размещения кейсов в прицепе (bin packing - First Fit Decreasing)
  - [x] Создать визуализацию прицепа с погруженными кейсами (2D вид сверху)
  - [x] Добавить форму для добавления кейсов (размеры, вес брутто/нетто)
  - [x] Реализовать статистику погрузки (вес, объем, использование)
  - [x] Добавить кнопку "Погрузить заново" для пересчета размещения
  - [x] Добавить компонент в навигацию App.tsx
  - [x] Обновить документацию (changelog.md, tasktracker.md)
  - [x] Исправить отображение стен прицепа (непрозрачность, backface-visibility)
  - [x] Добавить 3D-модель тягача перед прицепом для наглядности автопоезда
- **Зависимости**: Нет

## Задача: История редактирования и обновлений данных
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Реализовать историю изменений — кем, когда, что изменено; прошлые и текущие значения. Хранение в БД постоянно, срок жизни записи 1 год.
- **Шаги выполнения**:
  - [x] Миграция 002: entity_change_history (old_values, new_values)
  - [x] Модуль history: репозиторий, сервис, API GET /history
  - [x] Интеграция записи в роуты events, staff, equipment, equipment-categories, settings
  - [x] Frontend: страница «История изменений», фильтры, таблица «Было / Стало»
  - [x] Документация: changelog, tasktracker
  - [x] Миграция 004: retention 1 год, функция очистки
  - [x] HistoryRepository на PostgreSQL (персистентное хранение)
  - [x] Периодическая очистка записей старше 1 года (при старте и раз в 24 ч)
- **Зависимости**: Auth (actor_id из JWT), PostgreSQL

## Задача: Улучшение валидации регистрации и входа
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Добавить строгую валидацию логина и пароля с визуальными индикаторами и подсказками согласно требованиям.
- **Шаги выполнения**:
  - [x] Создать утилиты валидации логина и пароля (frontend и backend)
  - [x] Создать компонент FieldHint с тултипом
  - [x] Обновить Register.tsx: валидация в реальном времени, индикаторы, подсказки
  - [x] Обновить Login.tsx: валидация логина, индикаторы
  - [x] Обновить CSS: стили для валидных/невалидных полей
  - [x] Обновить валидацию на бэкенде (AuthService)
- **Зависимости**: Регистрация пользователей

## Задача: Регистрация пользователей
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Добавить возможность самостоятельной регистрации новых пользователей (email, пароль, отображаемое имя) с последующим входом в систему.
- **Шаги выполнения**:
  - [x] Backend: register в AuthService, валидация, права по умолчанию
  - [x] API: POST /auth/register, skipPaths для middleware
  - [x] Frontend: api.auth.register, register в AuthContext
  - [x] Frontend: компонент Register, переключатель с Login в App
  - [x] Документация: changelog, tasktracker
- **Зависимости**: Система авторизации (логин, JWT)

## Задача: Адаптация сайта для мобильных устройств
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Сделать адаптацию сайта для мобильных устройств, чтобы на мобильном устройстве всё выглядело лаконично и читаемо.
- **Шаги выполнения**:
  - [x] Добавить мобильное меню (гамбургер) и скрытие сайдбара на мобильных
  - [x] Адаптировать таблицы для мобильных устройств (карточки вместо таблиц)
  - [x] Адаптировать topbar и кнопки действий для мобильных
  - [x] Адаптировать модальные окна и формы для мобильных
  - [x] Адаптировать dashboard и карточки статистики
  - [x] Добавить адаптивные стили для фильтров и других компонентов
- **Зависимости**: Нет

## Задача: Оптимизация производительности кода
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Аудит кода, useMemo для дашборда и форм, меньше копий и проходов в backend, fix id стилей статусов.
- **Шаги выполнения**: App useMemo, formatDate/STATUS_LABELS, events sort in-place, update через findIndex, DashboardCharts/EventForm/Settings правки, changelog.
- **Зависимости**: Нет

## Задача: Сохранение авторизации в куки
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Реализовать сохранение токена авторизации в куки вместо localStorage, чтобы пользователь не вводил пароль при каждом входе.
- **Шаги выполнения**:
  - [x] Создать утилиту для работы с куками на фронтенде
  - [x] Изменить AuthContext для использования куки вместо localStorage
  - [x] Обновить api.ts для отправки credentials: include в запросах
  - [x] Обновить middleware на бэкенде для чтения токена из куки
  - [x] Настроить CORS на бэкенде для работы с куками
  - [x] Установить и подключить cookie-parser на бэкенде
- **Зависимости**: Нет

## Задача: Календарь-таймлайн для мероприятий
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Календарь в стиле Ганта: шкала сверху, проекты (по статусам) слева. Навигация скроллом; Ctrl+скролл — масштаб.
- **Шаги выполнения**:
  - [x] Группировка событий по статусам, проекты слева (блоки)
  - [x] Временная шкала: месяцы, кварталы, маркер «Сегодня»
  - [x] Навигация скроллом, Ctrl+колёсико = масштаб
  - [x] Стили: липкие колонки, сетка, легенда
- **Зависимости**: Календарь мероприятий с timeline-визуализацией

## Задача: Доработка системы прав доступа
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Расширить систему прав: быстрые роли, кастомная матрица редактирования.
- **Шаги выполнения**:
  - [x] Backend: роли (DTO, репо), GET /roles, displayName в UserPermissionsDto
  - [x] Frontend: API roles, типы RoleDto
  - [x] Быстрые роли: панель «применить роль → пользователь», «Роль» в таблице по строке
  - [x] Матрица прав: вид «Матрица», сетка пользователи × права, чекбоксы, сохранение
  - [x] Переключатель вида «Таблица» | «Матрица»
  - [x] Документация: changelog, api.md
- **Зависимости**: Система авторизации и управления правами доступа

## Задача: Исправление ошибок с setShowTooltip и Maximum update depth exceeded
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Исправить ошибки в консоли браузера: `Uncaught ReferenceError: setShowTooltip is not defined` и `Maximum update depth exceeded` в компоненте EventBar.
- **Шаги выполнения**:
  - [x] Исправить использование несуществующей функции `setShowTooltip` на `setShowTooltipLocal` в EventBar.tsx
  - [x] Улучшить логику `useEffect` для управления tooltip с проверкой внешнего управления состоянием
  - [x] Добавить правильную очистку timeout'ов в `useEffect`
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Компонент EventBar, система tooltip
- **Результат**: Ошибки в консоли исправлены, tooltip работает корректно

## Задача: Инициализация документации
- **Статус**: Завершена
- **Приоритет**: Критический
- **Описание**: Создать базовые документы проекта и зафиксировать архитектуру.
- **Шаги выполнения**:
  - [x] Создать папку docs и базовые документы.
  - [x] Заполнить Project.md с архитектурой и стандартами.
  - [x] Создать Diary.md и qa.md.
  - [x] Создать changelog.md.
- **Зависимости**: Нет

## Задача: Сбор требований и детализация домена
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Уточнить роли, процессы и данные для модулей.
- **Шаги выполнения**:
  - [x] Зафиксировать черновые требования и статусы.
  - [x] Собрать ответы и уточнения по требованиям.
  - [x] Уточнить бизнес-правила и ограничения.
  - [x] Согласовать набор отчетов.
- **Зависимости**: Project.md

## Задача: Проектирование модели данных
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Разработать ER-модель для ключевых сущностей.
- **Шаги выполнения**:
  - [x] Определить сущности и атрибуты.
  - [x] Спроектировать связи и ограничения.
  - [x] Подготовить миграции.
- **Зависимости**: Сбор требований и детализация домена

## Задача: MVP - управление событиями и персоналом
- **Статус**: В процессе
- **Приоритет**: Средний
- **Описание**: Реализовать базовые сценарии работы с мероприятиями и персоналом.
- **Шаги выполнения**:
  - [x] Подготовить DTO и контуры API.
  - [x] Описать правила валидации для DTO.
  - [x] Подготовить CRUD-контуры (in-memory).
  - [x] Добавить in-memory контроллеры.
  - [x] CRUD для Event и Staff (валидация/ошибки).
  - [x] Назначение персонала на мероприятия (DTO/CRUD контуры).
  - [x] Базовые отчеты по занятости (utilization).
  - [x] Фильтрация назначений по статусу/датам.
  - [x] Продвинутый поиск мероприятий (filters).
  - [x] Сортировка и пагинация мероприятий.
- **Зависимости**: Проектирование модели данных

## Задача: Проектирование API и структуры проекта
- **Статус**: В процессе
- **Приоритет**: Высокий
- **Описание**: Зафиксировать контуры API и структуру проекта.
- **Шаги выполнения**:
  - [x] Описать черновой API для MVP.
  - [x] Зафиксировать структуру backend/frontend.
  - [x] Подготовить базовые каркасы проектов (ручной каркас).
  - [x] Переинициализировать frontend через Vite.
- **Зависимости**: Проектирование модели данных

## Задача: Frontend UI каркас
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Подготовить рабочий UI каркас для MVP.
- **Шаги выполнения**:
  - [x] Базовый layout и навигация.
  - [x] Страницы Events и Staff.
  - [x] Стартовый Dashboard.
  - [x] Полные стили для всех компонентов.
- **Зависимости**: Проектирование API и структуры проекта

## Задача: Запуск проекта в рабочее состояние
- **Статус**: Завершена
- **Приоритет**: Критический
- **Описание**: Исправить ошибки и запустить frontend и backend серверы.
- **Шаги выполнения**:
  - [x] Создать package.json для backend.
  - [x] Добавить полные стили для frontend.
  - [x] Создать Express сервер с API endpoints.
  - [x] Исправить ошибки типизации.
  - [x] Установить зависимости.
  - [x] Запустить оба сервера.
- **Зависимости**: Frontend UI каркас, Проектирование API и структуры проекта

## Задача: Базовые конфиги и окружение
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Подготовить минимальные конфиги и env для ручного каркаса.
- **Шаги выполнения**:
  - [x] Добавить tsconfig и базовые настройки.
  - [x] Добавить env.example для backend и frontend.
  - [x] Описать стартовые скрипты в README.
- **Зависимости**: Проектирование API и структуры проекта

## Задача: Разработка раздела Events
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Реализовать полный функционал работы с мероприятиями: создание, просмотр, редактирование, продвинутый поиск.
- **Шаги выполнения**:
  - [x] Создать API сервис для работы с backend (frontend/src/services/api.ts)
  - [x] Реализовать форму создания/редактирования мероприятий с валидацией
  - [x] Реализовать детальный просмотр мероприятия (detail view)
  - [x] Создать продвинутый поиск с фильтрацией (статус, даты, клиент, площадка, бюджет, текст)
  - [x] Добавить API endpoints для получения клиентов и площадок
  - [x] Интегрировать frontend с backend API
  - [x] Добавить стили для всех новых компонентов
  - [x] Обновить документацию
- **Зависимости**: Frontend UI каркас, Запуск проекта в рабочее состояние

## Задача: Дизайн-система с поддержкой темной и светлой темы
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Создать полноценную дизайн-систему с поддержкой темной и светлой темы, используя оранжевый акцентный цвет из логотипа компании.
- **Шаги выполнения**:
  - [x] Создать систему CSS переменных для обеих тем
  - [x] Реализовать компонент переключения темы с сохранением в localStorage
  - [x] Интегрировать оранжевый акцентный цвет (#FF8C00) из логотипа
  - [x] Обновить все стили для использования CSS переменных
  - [x] Добавить логотип компании в брендинг
  - [x] Обеспечить поддержку автоматического определения системной темы
  - [x] Обновить документацию
- **Зависимости**: Frontend UI каркас

## Задача: Разработка раздела Staff
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Реализовать полный функционал работы с персоналом: создание, редактирование, детальный просмотр, деактивация.
- **Шаги выполнения**:
  - [x] Добавить типы и методы для staff в API сервис
  - [x] Создать форму создания/редактирования персонала (StaffForm)
  - [x] Создать детальный просмотр персонала (StaffDetail)
  - [x] Интегрировать компоненты staff в App.tsx
  - [x] Проверить и исправить ошибки
  - [x] Обновить документацию
- **Зависимости**: Разработка раздела Events

## Задача: Календарь мероприятий с timeline-визуализацией
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Разработать удобный календарь мероприятий с timeline-визуализацией и выбором диапазона дат.
- **Шаги выполнения**:
  - [x] Создать компонент EventCalendar с timeline-визуализацией
  - [x] Добавить DateRangePicker для выбора диапазона дат
  - [x] Реализовать быстрые кнопки выбора диапазона (7/30/90 дней, этот месяц)
  - [x] Добавить навигацию по месяцам
  - [x] Реализовать позиционирование мероприятий на timeline
  - [x] Добавить цветовую индикацию статусов
  - [x] Создать стили для календаря
  - [x] Интегрировать календарь в раздел мероприятий
  - [x] Обновить документацию

## Задача: Преобразование календаря в диаграмму Ганта с масштабированием
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Переделать календарь в формат диаграммы Ганта с возможностью масштабирования временной шкалы.
- **Шаги выполнения**:
  - [x] Переделать структуру календаря в формат диаграммы Ганта
  - [x] Добавить масштабирование (zoom) для временной шкалы
  - [x] Реализовать алгоритм размещения событий без перекрытий
  - [x] Добавить временную шкалу с выбором единиц (часы/дни/недели/месяцы)
  - [x] Реализовать синхронизацию прокрутки заголовка и тела диаграммы
  - [x] Добавить липкие элементы (sticky) для заголовка и колонки названий
  - [x] Обновить стили для диаграммы Ганта
  - [x] Обновить документацию
- **Зависимости**: Календарь мероприятий с timeline-визуализацией

## Задача: Система авторизации и управления правами доступа
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Реализовать авторизацию (JWT), права доступа по id и email, страницу управления правами.
- **Шаги выполнения**:
  - [x] Backend: users, permissions (in-memory), JWT login/me, сид admin
  - [x] Backend: auth middleware, защита API, CRUD прав по userId/email
  - [x] Frontend: Login, AuthContext, api с токеном, 401 → выход
  - [x] Страница «Управление доступом», видимая только при access:manage
  - [x] Документация: changelog, tasktracker, api.md
- **Зависимости**: Нет

## Задача: Модуль склада с управлением оборудованием
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Создать вкладку склад с возможностью создавать, редактировать, удалять оборудование. В detail view должны быть фото, название, модель, производитель, ответвление (свет, звук, ригг, прочее), чтобы эти ответвления можно было редактировать и создавать самому. Также нужно использование серийных номеров и учёт передвижения оборудования.
- **Шаги выполнения**:
  - [x] Создать бэкенд модуль для категорий оборудования (equipment-categories) с CRUD операциями
  - [x] Создать бэкенд модуль для оборудования (equipment) с полями: название, модель, производитель, категория, серийный номер, фото
  - [x] Создать бэкенд модуль для учёта передвижения оборудования (equipment-movements)
  - [x] Добавить API endpoints в main.ts для всех модулей склада
  - [x] Создать фронтенд API методы в api.ts для оборудования и категорий
  - [x] Создать компоненты EquipmentForm, EquipmentDetail, EquipmentList на фронтенде
  - [x] Добавить вкладку Склад в App.tsx с навигацией и управлением
  - [x] Добавить компонент для управления категориями оборудования
  - [x] Добавить функциональность загрузки и отображения фото оборудования
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Нет

## Задача: Заполнение склада большим количеством оборудования и категорий
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Заполнить склад большим количеством реалистичного оборудования и категорий для тестирования и демонстрации.
- **Шаги выполнения**:
  - [x] Создать seed файл для оборудования (seed.ts)
  - [x] Добавить дополнительные категории (Видео, Сценическое, Кабели, Инструменты, Транспорт, Безопасность)
  - [x] Добавить большое количество оборудования (более 200 единиц)
  - [x] Реализовать автоматическое заполнение при запуске сервера
  - [x] Добавить разнообразное оборудование с разными статусами
  - [x] Обновить документацию (changelog.md и tasktracker.md)
- **Зависимости**: Система управления складом

## Задача: Представление категорий оборудования в виде дерева
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Отображать категории оборудования иерархически (дерево) с возможностью создавать подкатегории и выбирать родителя.
- **Шаги выполнения**:
  - [x] Backend: добавить `parentId` в DTO и репозиторий категорий
  - [x] Обновить seed: подкатегории под «Прочее»
  - [x] Фронтенд: утилиты `buildCategoryTree`, `categoryPath`, `categoryOptions`
  - [x] EquipmentCategoryManager: дерево с раскрытием, форма с выбором родителя
  - [x] EquipmentForm и EquipmentFilters: выбор категории с путём (например, «Прочее › Видео»)
  - [x] Обновить документацию (changelog.md, tasktracker.md)
- **Зависимости**: Модуль склада, категории оборудования

## Задача: Заполнение страницы склада и добавление статистики на dashboard
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Улучшить страницу склада с фильтрами и статистикой, добавить статистику склада на dashboard.
- **Шаги выполнения**:
  - [x] Создать компонент EquipmentFilters для фильтрации оборудования
  - [x] Добавить статистические карточки на страницу склада (общее количество, по статусам)
  - [x] Улучшить отображение таблицы оборудования (добавить категорию, улучшить фильтрацию)
  - [x] Добавить статистику склада на dashboard (карточки с общим количеством и в работе)
  - [x] Реализовать логику фильтрации оборудования (по статусу, категории, тексту, производителю)
  - [x] Обновить документацию (changelog.md и tasktracker.md)
- **Зависимости**: Система управления складом

## Задача: Проверка кода и исправление ошибок
- **Статус**: Завершена
- **Приоритет**: Высокий
- **Описание**: Полная проверка кода (frontend, backend), исправление ошибок линтера, TypeScript и логики.
- **Шаги выполнения**:
  - [x] Проверить backend: lint, build
  - [x] Проверить frontend: lint, build
  - [x] Исправить ошибки ESLint (any, unused vars, react-hooks, react-refresh)
  - [x] Исправить ошибки TypeScript (import type, verbatimModuleSyntax)
  - [x] Исправить backend: return при 404 в GET-by-id
  - [x] Добавить загрузку оборудования на вкладке «Склад»
  - [x] Обновить changelog.md и tasktracker.md
- **Зависимости**: Нет

## Задача: Раздел настроек для редактирования статусов и цветов дизайна
- **Статус**: Завершена
- **Приоритет**: Средний
- **Описание**: Создать раздел настроек, где можно редактировать статусы (их названия и цвета), а также цвета дизайна сайта (светлая и темная тема).
- **Шаги выполнения**:
  - [x] Создать backend модуль settings с API для получения и сохранения настроек
  - [x] Создать компонент Settings во frontend с формами для редактирования статусов и цветов
  - [x] Добавить API методы в frontend для работы с настройками
  - [x] Добавить страницу настроек в навигацию App.tsx
  - [x] Реализовать динамическое применение цветов через CSS переменные
  - [x] Добавить редактирование статусов событий (draft, request, in_work, completed, canceled)
  - [x] Добавить редактирование статусов персонала (active, inactive)
  - [x] Добавить редактирование цветов светлой и темной темы
  - [x] Добавить предпросмотр изменений цветов в реальном времени
  - [x] Добавить функцию сброса настроек к значениям по умолчанию
  - [x] Обновить документацию
- **Зависимости**: Дизайн-система с поддержкой темной и светлой темы
